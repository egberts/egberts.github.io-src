Title: Bind9 Directories and Files
Date: 2018-10-18 18:56
Modified: 2021-12-19 09:11
slug: bind9-directories
tags: bind9
category: research
summary: Directories and Files used by ISC Bind9

Bind9 directories
=================

The following directories used by Bind9 package and its `named` daemon are listed for various distro filesystem layout.

Autoconf, autoreconf, configure
-------------------------------
At the beginning, certain distros places Bind9 into different directories as a Bind9 default.

[jtable]
Disto name, `prefix`, `sysconfdir`, `localstatedir`, `libdir`
Debian 11, `/usr`, `/etc/bind`, `/run/bind`, `/var/lib/bind`
Debian 10, `/usr`, `/etc/bind`, `/run`, `/var/lib/bind`
Debian 9, `/usr`, `/etc`, `/var/run`, `/var/lib/bind`
Redhat, `/usr`, `/etc`, `/var/run`, `/var/named`
OpenSUSE, `/usr`, `/etc`, `/run`, `/var/lib/named`
ISC maintainer, `/usr`, `/etc`, `/var`, `/var/lib/bind`
[/jtable]

Bind9 Directory Group
---------------------
The general set of directories that Bind9 uses are:


[jtable]
Directory name, named.conf Statement, Description
`/etc/bind`, directory, directory is a quoted string defining the absolute path for the server e.g. &quot;/var/named&quot;. All subsequent relative paths use this base directory. If no directory options is specified the directory from which BIND was loaded is used. This option may only be specified in a 'global' options statement.
`/var/lib/bind`, ,
`/var/lib/bind/master`, `file`, zone files
`/var/lib/bind/keys`, `key-directory`, "key-directory is a quoted string defining the absolute path, for example, &quot;/var/lib/bind/dynamic&quot; where the keys used in the dynamic update of secure zones may be found. Only required if this directory is different from that defined by a directory option. This statement may only be used in a global options clause. Used to be `/etc/bind/keys` directory.`rndc` `loadkeys` and `rndc` `sign` reads from this directory. "
`/var/lib/bind/dynamic`, `managed-keys-directory`, Zone files; filetype is typically `*.mkeys`.
`/etc/default/bind`, , Default systemd settings for `named` daemon startup (<a href="bind9.service" class="uri" title="wikilink">bind9.service</a>). 
`/var/cache/bind`, `key-directory`, Dynamically created keyfiles by named daemon.  It is also the $HOME directory for named process.  
[/jtable]

`logdir` is not controlled by the `autoconf`/`configure` tool: actual filespec for each channel's log file is entirely user-definable by using `file` statement in its `channel` clause.

Note: The `logdir` is historically defined as `/var/log/named`; Future packaging may migrate toward `/var/log/bind` (despite some resistance by various log-ingestion tool providers).



Bind9 files
===========
The following are files used by Bind9 `named` in Debian distro filesystem
layout.

[jtable]
Filespec, Derived from, Description
`/var/run/named/named.pid`, `pid-file`, "PID number of the master named process in text-format. pid-file is a quoted string and allows you to define where the pid (Process Identifier) used by BIND is written. If not present it is distribution or OS specific typically /var/run/named.pid or /etc/named.pid. It may be defined using an absolute path or relative to the directory parameter. This statement may only be used in a global options clause. Debian uses `/run/named/named.pid`."
`/var/cache/bind/session.key`, `session-keyfile`, "The pathname of the file into which to write a TSIG session key generated by named for use by 'nsupdate -l'.  If not specified the default is given in the named $HOME directory as specified in `/etc/passwd`.  "
`/etc/bind/rndc.conf`, (default) , "Used by `rndc` utility. Manually created and often formatted like:</p> `   # Start of rndc.conf`<br /> `   include &quot;/etc/bind/rndc.key&quot;;`<br /> `   options {`<br /> `       default-key &quot;rndc-key&quot;;`<br /> `       default-server 127.0.0.1;`<br /> `       default-port 953;`<br /> `   };`<br /> `   # End of rndc.conf`"
`/etc/bind/keys/rndc.key`, , its key is created using `rndc-confgen` `-a` looking like this:</p> <p>`   key &quot;rndc-key&quot; {`<br /> `       algorithm hmac-md5;`<br /> `       secret &quot;XbAxWyZPL74rN1Ti3dTV9a==&quot;;`<br /> `   };`
`/var/cache/bind/managed-keys.bind.jnl`, `journal`, Keeps track of changed keys after the `initial-key` statement in `trust-anchors` clause.
`/var/cache/bind/*.jnl`, `journal`, Keeps track of changes being made to the zone databases
`/var/cache/bind/{zone}.jbk`, `$HOME`, "A backup of `*.jnl`  in which keeps track of changes being made to the zone databases. Defaults to named $HOME directory (`/var/cache/bind`) as defined in `/etc/passwd`.  There doesn't seem to be a `named.conf` configuration statement to alter this location. (`*.jnl` is stored in a separate directory pointed to by zone's `file` statement)."
`/var/cache/bind/cache\_dump.db`, `dump-file`, "Dumps the DNS cache database into a text file. dump-file is a quoted string defining the absolute path where BIND dumps the database (cache) in response to a rndc dumpdb. If not specified the default is named_dump.db in the location specified by a directory option. This option may only be specified in a 'global' options statement. "
`/var/lib/bind/dynamic/\<hash\>.mkeys`, `dynamic`, maintains all keys in a directory defined by `managed-keys-directory` config item.  Files have `.mkeys` filetype.  If in view-mode filename is hash value of its zone name.
`/var/log/bind/named\_stats.txt`, `statistics-file`, Dumps the statistics into a file. This statement defines the file-name to which data will be written when the command rndc stats is issued. May be an absolute or relative (to directory) path. If the parameter is not present the information is written to named.stats in the path defined by directory or its default. This statement may only be used in a global options clause.
`/var/log/mem-statistics.log` , `memstatistics-file` , This statement defines the file-name to which BIND memory usage statistics will be written when it exits. May be an absolute or relative (to directory) path. If the parameter is not present the stats are written to `named.memstats` in the path defined by directory or its default. This statement may only be used in a global options clause.
`/etc/bind/named.iscdlv.key` , `bindkeys-file` , OBSOLETED. Holds the DLV (now discontinued as of Feb 2017). Used to be `/etc/bind.keys`
`named.secroots`, `secroots-file`, Default filename to the the pathname of the file that server dumps security roots into when instructed to do so via 'rndc secroots' command.
[/jtable]


Bind9 logging channels
======================
The following category names used in logging of named daemon are supported in Bind v9.17.

Actual filespec for each channel's log file is entirely user-definable by using the `file` statement.

Directory path for file-based channel is commonly `/var/log/named`.  

Note: While the conventional directory path should be `/var/log/bind` but many DNS-related log-ingestion programs have been accustomed to `/var/log/named`.

[jtable]
Category name , Description
`default` , Logging options for those categories where no specific configuration has been defined.
`general` , Catch-all for many things that still are not classified into categories.
`database` , Messages relating to the databases used internally by the name server to store zone and cache data.
`security` , Approval and denial of DNS requests.

`client` , Client requests and events get logged.
`cname` ,  Name servers that are skipped for being a CNAME instead of an A/AAAA.
`config` , Configuration file, parse processing, and any misconfiguration events .
`delegation-only` , Queries that have been forced to NXDOMAIN as a result of delegation-only zone or a delegation-only in `forward`, `hint`, or `stub` zone. 
`dispatch` , Dispatching of incoming packet to the server modules where they are to be processed.
`dnssec` , DNSSEC and TSIG protocol processing.
`dnstap` , The "dnstap" DNS traffic capture system.
`edns-disable` , "Log queries that have been forced to use plain DNS due to timeouts. This is often due to the remote servers not being :rfc:`1034`-compliant (not always returning FORMERR or similar to EDNS queries and other extensions to the DNS when they are not understood). In other words, this is targeted at servers that fail to respond to DNS queries that they don't understand."
`lame-servers` , "Misconfigurations in remote servers, discovered by BIND 9 when trying to query those servers during resolution."
`network` , "Network events get logged. open() close() dropped or downed network interface."
`notify` , Notify protocols and events.
`nsid` , "NSID options received from upstream nameservers.
`queries` , "Location where queries should be logged.  At startup, specifying the category `queries` also enables query logging unless the `querylog` option has been specified."
`query-errors` , Information about queries that resulted in some failure.
`rate-limit` , "Start, periodic, and final notices of the rate limiting of a stream of responses that are logged at `info` severity in this category. These messages include a hash value of the domain name of the response and the name itself, except when there is insufficient memory to record the name for the final notice. The final notice is normally delayed until about one minute after rate limiting stops. A lack of memory can hurry the final notice, which is indicated by an initial asterisk (\*). Various internal events are logged at debug level 1 and higher.  Rate limiting of individual requests is logged in the `query-errors` category."
`resolver` , DNS resolution, such as the recursive lookups performed on behalf
`rpz`, "Information about errors in response policy zone files, rewritten responses, and, at the highest `debug` levels, mere rewriting attempts.
`serve-stale` , Indication of whether a stale answer is used following a resolver failure.
`spill` , "Queries that have been terminated, either by dropping or responding with SERVFAIL, as a result of a fetchlimit quota being exceeded."
`trust-anchor-telemetry`, Trust-anchor-telemetry requests received by `named`.
`unmatched` , "Messages that `named` was unable to determine the class of, or for which there was no matching `view`. A one-line summary is also logged to the `client` category. This category is best sent to a file or stderr; by default it is sent to the `null` channel. "
`update` , Dynamic update events.
`update-security` , Security update events get logged.
`xfer-in` , Zone transfers the server is receiving.
`xfer-out` , Zone transfers the server is sending.
`zoneload` , Loading of zones and creation of automatic empty zones.
[/jtable]
